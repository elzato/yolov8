<!DOCTYPE html>
<html>
<head>
    <title>English Vocabulary Builder</title>
    <style>
        #camera { width: 640px; height: 480px; border: 3px solid #ccc; }
        .object-label { 
            position: absolute; 
            background: rgba(0,255,0,0.5); 
            padding: 5px; 
            color: white; 
            font-weight: bold;
        }
    </style>
</head>
<body>
    <h1>Learn English with Objects Around You!</h1>
    <video id="camera" autoplay></video>
    <button id="startBtn">Start Learning</button>
    <div id="labelsContainer"></div>

    <script>
        const camera = document.getElementById('camera');
        const startBtn = document.getElementById('startBtn');
        const labelsContainer = document.getElementById('labelsContainer');
        
        startBtn.addEventListener('click', async () => {
            const stream = await navigator.mediaDevices.getUserMedia({ video: true });
            camera.srcObject = stream;
            
            setInterval(detectObjects, 1000); // Deteksi setiap 1 detik
        });
        
        async function detectObjects() {
            // Ambil frame dari kamera
            const canvas = document.createElement('canvas');
            canvas.width = camera.videoWidth;
            canvas.height = camera.videoHeight;
            const ctx = canvas.getContext('2d');
            ctx.drawImage(camera, 0, 0, canvas.width, canvas.height);
            const imageData = canvas.toDataURL('image/jpeg');
            
            // Kirim ke backend
            const response = await fetch('https://your-backend-url.onrender.com/detect', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ image: imageData })
            });
            
            const results = await response.json();
            displayResults(results.detections);
        }
        
        function displayResults(detections) {
            labelsContainer.innerHTML = '';
            
            detections.forEach(det => {
                if(det.confidence > 0.5) { // Hanya tampilkan yang confident
                    const label = document.createElement('div');
                    label.className = 'object-label';
                    label.textContent = det.label;
                    label.style.left = `${det.bbox[0]}px`;
                    label.style.top = `${det.bbox[1]}px`;
                    labelsContainer.appendChild(label);
                    
                    // Baca label (opsional)
                    const speech = new SpeechSynthesisUtterance(det.label);
                    window.speechSynthesis.speak(speech);
                }
            });
        }
    </script>
</body>
</html>
